#!/usr/bin/env python3

import angr, time, io
from pwn import *

FIND_ADDR=0x4013d2
t=time.time()
bits = open('./thereisnospoon','rb').read()
proj = angr.Project(io.BytesIO(bits),auto_load_libs=False)
state = proj.factory.entry_state()
simgr = proj.factory.simulation_manager(state)
simgr.use_technique(angr.exploration_techniques.DFS())
simgr.explore(find=FIND_ADDR)
log.info(str(time.time() - t) + ' seconds')

binary = context.binary = ELF('./thereisnospoon')
context.log_level = 'INFO'

if not args.REMOTE:
	context.log_file = 'local.log'
	p = process(binary.path)
else:
	context.log_file = 'remote.log'
	p = remote('chal.ctf.b01lers.com', 1006)

p.send(simgr.found[0].posix.dumps(0))
p.interactive()
